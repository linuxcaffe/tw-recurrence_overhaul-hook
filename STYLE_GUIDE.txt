# David's Development Style Guide - Quick Reference

## Critical Rules
1. **ALWAYS ASK before generating new file versions** - David often has comments
2. **If you can't find current files, ASK for them** - don't guess
3. **Assume Taskwarrior v2.6.2** - never use v3.x methods/code
4. **Smart coding over quick fixes** - aim for reliable products
5. **Check project files first** - they're in /mnt/project/
6. **Check access to key reference docs uploaded; Hooks API, man pages for task.1 and taskrc.5. c++ taskwarrior source files are available for the asking

## File Management
- Project files: `/mnt/project/` (read-only copies of David's actual project)
- Uploaded files may appear in: `/mnt/project/` or `/mnt/user-data/uploads/`
- Always use `view` tool to check current file versions before editing
- Version numbers matter - check them first

## Documentation Style
- **Track changes in recurrence_CHANGES.txt** - not DEVELOPERS.md
- Use clear "Fixed/Added/Changed" categories
- Include version numbers and dates
- Technical details are good, but keep it concise

## Communication Preferences
- Be direct and technical
- No excessive pleasantries or verbose explanations
- Show code/examples rather than describing them
- Compact summaries > long explanations
- Ask clarifying questions when uncertain

## Project Context: Taskwarrior Enhanced Recurrence
- **Current versions:** Hooks v0.5.2, Test suite v0.3.3 (?? maybe old news)
- **Architecture:** Two hooks (on-add, on-exit ) + test suite + config file
- **Goal:** Advanced recurring task system for Taskwarrior 2.6.2
- **Status:** Core functionality working, test suite being refined
- **Hook locations:** ~/.task/hooks/recurrence/ (actual), /mnt/project/ (copies)

## Code Style
- Python hooks: Clear, well-commented, lazy loading for config
- Bash tests: Helper functions, clean output, isolated environments
- Debug logging: Conditional, informative, not verbose
- Error handling: Graceful fallbacks, clear messages

## Test Philosophy
- Fix test bugs separate from feature issues
- Tests should validate actual behavior, not messages
- Isolated test environments (use /tmp)
- Plain text output files (no ANSI codes)

## Common Patterns
- **ttask()** - task command with test config
- **ttask_export()** - task export with filtered stderr
- **ttask_count()** - count with clean numeric output
- **debug_log()** - conditional logging to file
- **get_config()** - lazy config loading with cache

## What David Values
- Systematic approaches with version control
- Comprehensive test coverage
- Detailed debugging when needed
- Organized directory structures
- Building reliable, maintainable code

## Quick Checks Before Responding
1. Did I check current file versions?
2. Am I assuming v2.6.2 (not v3.x)?
3. Should I ask before regenerating files?
4. Are my changes documented in CHANGES.txt?
5. Is my explanation compact enough?

## When User Uploads Files
- Check both /mnt/project/ and /mnt/user-data/uploads/
- Look for newest by timestamp if multiple versions exist
- Confirm which version they're working with
- Read the file before proposing changes

## Red Flags to Avoid
- "I don't have access to..." - Use tools to search/check
- Verbose post-ambles after presenting solutions
- Assuming changes without checking current state
- Using v3.x Taskwarrior features
- Making changes without asking first
- Putting change notes in DEVELOPERS.md instead of CHANGES.txt

## Current Session Context
- Working on: Test suite v0.3.3 refinement
- Recent fix: ttask_count helper, color code stripping
- Next likely: More test failures to investigate
- Tests passing: 6/14 (was 5/14, then improved)
- Hooks are working correctly - test issues are test script bugs or real feature gaps

## Response Format David Prefers
1. Quick summary of findings (2-3 lines)
2. Code/changes (if applicable)
3. What to expect
4. No lengthy explanations unless requested

---
Last updated: 2026-01-13 | Hooks v0.5.2 | Tests v0.3.3 | Context window getting full
